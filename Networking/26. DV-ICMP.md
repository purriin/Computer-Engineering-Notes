- Counting to infinity problem
	- Nodes believe best path is through each other
- Poisoned Reverse
	- Report route to a destination to the neighbor form which route was learned as an infinite distance 
	- Not always effective

- Why is Link State preferred?
	- Fast, loopless convergence
	- Less routing information for transmission to neighbour nodes
		- Note that the number of links is usually much smaller than the number of networks
	- Support for precise metrics and multiple metrics if necessary (throughput, delay, cost, reliability)
	- Support for multiple paths to a destination
		- E.g., the algorithm can be modified to find the best two paths

## 26.1 Internet Control Message Protocol (ICMP)
- Used by hosts and routers to communicate network-level information
- Error reporting: unreachable host, network, port, protocol
- Echo Request/Reply: Used by ping

#### Network Layer Protocol
- Network-layer "above" IP:
	- ICMP messages carried in IP datagrams
- The ICMP header starts after the IPv4 header and is identified by Protocol Number "1"

#### ICMP Header
- All ICMP packets will have an 8-byte header and variable-sized data section:
	- First byte is for the ICMP type
	- The second byte is for the ICMP code
	- The third and fourth bytes are a checksum of the entire ICMP message
	- The contents of the remaining 4 bytes of the header will vary based on the ICMP type and code

| Type | Code | Description                                   |
| ---- | ---- | --------------------------------------------- |
| 0    | 0    | echo reply (ping)                             |
| 3    | 0    | dest network unreachable                      |
| 3    | 1    | dest host unreachable                         |
| 3    | 2    | dest protocol unreachable                     |
| 3    | 3    | dest port unreachable                         |
| 3    | 6    | dest network unknown                          |
| 3    | 7    | dest host unknown                             |
| 4    | 0    | source quench (congestion control - not used) |
| 8    | 0    | echo request (ping)                           |
| 9    | 0    | route advertisement                           |
| 10   | 0    | router discovery                              |
| 11   | 0    | TTL expired                                   |
| 12   | 0    | bad IP header                                 |
- ICMP message: type, code plus first 8 bytes of IP datagram causing error

#### ICMP Error Reporting
- ICMP does not correct errors, it simply reports them
- Error messages are always sent to the original source because the only information available in the datagram about the route is the source and destination addresses
- ICMP uses the source IP address to send the error message to the source of the datagram

#### Traceroute and ICMP
- Source sends sets of UDP segments to destination
	- 1st set has TTL = 1
	- 2nd set has TTL = 2
	- Etc.
- Datagram in the nth set arrives to the nth router:
	- Router discards datagram and sends source ICMP message (type 11, code 0)
	- ICMP message possibly includes name of router and IP address
- When ICMP message arrives at source: record RTTs

- Stopping criteria:
	- UDP segment eventually arrives at destination host
	- Destination returns ICMP "port unreachable" message (type 3, code 3)
	- Source stops