- **IP Address**: 32-bit identifier associated with each host or router *interface*
- **Interface**: Connection between host/router and physical link
	- Routers typically have multiple interfaces
	- Hosts typically have one or two interfaces

## 20.1 Communication Networks and Services

### 20.1.1 Classful Addresses
###### Class A
| 0   | `netid` (7 bits) | `hostid` (24 bits) |
| --- | ---------------- | ------------------ |
- 126 networks with up to 16 million hosts
- 1.0.0.0 to 127.255.255.255
###### Class B
| 1   | 0   | `netid` (14 bits) | `hostid` (16 bits) |
| --- | --- | ----------------- | ------------------ |
- 16 382 networks with up to 64 000 hosts
- 128.0.0.0 to 191.255.255.255
###### Class C
| 1   | 1   | 0   | `netid` (21 bits) | `hostid` (8 bits) |
| --- | --- | --- | ----------------- | ----------------- |
- 2 million networks with up to 254 hosts
- 192.0.0.0 to 223.255.255.255
###### Class D
| 1   | 1   | 1   | 0   | `multicast address` (28 bits) |
| --- | --- | --- | --- | ----------------------------- |
- 224.0.0.0 to 239.255.255.255
- Up to 250 million multicast groups at the same time
- Permanent group addresses
- Temporary group addresses created as needed
- Special multicast routers

### 20.1.2 Reserved Host IDs (All 0s and 1s)
- Internet address used to refer to network address set to all 0s

| 0   | 0   | 0   | 0   |     | 0   | 0   |
| --- | --- | --- | --- | --- | --- | --- |
- This host (used when booting up)

| 0   | 0   |     | 0   | host |
| --- | --- | --- | --- | ---- |
- A host in this network

- Broadcast address has `hostid` set to all 1s

| 1   | 1   | 1   | 1   |     | 1   | 1   |
| --- | --- | --- | --- | --- | --- | --- |
- Broadcast on local network

| `netid` | 1   | 1   | 1   |     | 1   | 1   | 1   | 1   |
| ------- | --- | --- | --- | --- | --- | --- | --- | --- |
- Broadcast on distant network

### 20.1.3 Private IP Addresses
- IP addresses set aside for private networks
- Routers in public Internet discard packets with these addresses:
	- Range 1: 10.0.0.0 to 10.255.255.255
	- Range 2: 172.16.0.0 to 172.31.255.255
	- Range 3: 192.168.0.0 to 192.168.255.255
- Network Address Translation (NAT) used to convert between private and global IP addresses

### 20.1.4 Subnets
**Subnet Addressing**
- Large Class B networks can be separated into subnetworks
	- Transparent to remote networks
	- Simplifies management of multiplicity of LANs
	- Masking used to find subnet address

**Subnet**: Device interfaces that can physically reach each other without passing through and intervening router

- IP addresses have structure:
	- Subnet part: devices in same subnet have common high order bits
	- Host part: remaining low order bits

**Subnet Mask**
Apply subnet mask to IP addresses to find corresponding subnet  
- Example: Find subnet for 150.100.12.176  
- IP add = 10010110 01100100 00001100 10110000  
- Mask = 11111111 11111111 11111111 10000000  
- AND = 10010110 01100100 00001100 10000000  
- Subnet = 150.100.12.128  
- Subnet address used by routers within organization  

**Subnet Example**
- An organization has a Class B address (16 host ID bits) with network ID: 150.100.0.0
- Create subnets with up to 100 hosts each  
	- 7 bits sufficient for each subnet  
	- 16-7=9 bits for the subnet ID

- Recipe for defining subnets:
	- Detach each interface from its host or router, creating "islands" of isolated networks
	- Each isolated network is called a subnet

**Routing with Subnetworks**
- IP layer in hosts and routers maintain a forwarding (routing) table  
- Originating host: To send an IP packet, consult forwarding (routing) table  
	- If destination host is in same network, send packet directly using appropriate network interface  
	- Otherwise, send packet indirectly; typically, routing table indicates a default router  
- Router: Examine IP destination address in arriving packet  
	-  If dest IP address not own, router consults routing table to determine next-hop and associated network interface & forwards packet

**Routing Table**
- Each row in routing table contains:
	- Destination IP address
	- IP address of next hop router
	- Physical address
	- Statistics information
	- Flags
		- H = 1 (0) indicates route is to a host (network)
		- G = 1 (0) indicated route is to a router (directly connected destination)
- Routing table search order and action
	- Complete destination address; send as per next hop and G flag
	- Destination network ID; send as per next hop and G flag
	- Default router entry; send as per next hop
	- Declare packet undeliverable; send ICMP "host unreachable error" packet to originating host