## 6.1 Web & HTTP
- Web page consists of *objects*, each of which can be stored on different Web servers
- Object can be HTML file, JPEG image, Java applet, audio file
- web page consists of *base HTML file* which includes *several referenced objects, each* addressable by a *URL*

## 6.2 HTTP Overview
**HTTP**: Hypertext transfer protocol
- Web's application layer protocol
- client/server model:
	- **Client**: Browser that requests, received, (using HTTP protocol) and "displays" Web objects
	- **Server**: Web server sends (using HTTP protocol) objects in response to requests
- HTTP uses TCP:
	- Client initiates TCP connection (creates socket) to server, port 80
	- Server accepts TCP connection from client
	- HTTP messages (application-layer protocol messages) exchanged between browser (HTTP client) and Web server (HTTP server)
	- TCP connection closed
- HTTP is "stateless"
	- Server maintains no information about past client requests
- Protocols that maintain "state" are complex
	- Past history (state) must be maintained
	- If server/client crashes, their views of "state" may be inconsistent must be reconciled

**2 Types of HTTP Connections**:
1. Non-persistent HTTP 1.0
	1. TCP connection opened
	2. At most one object sent over TCP connection
	3. TCP connection closed
	- Downloading multiple objects required multiple connections

2. Persistent HTTP 1.1
	1. TCP connection open to a server
	2. Multiple objects can be sent over a *single* TCP connection between client and that server
	3. TCP connection closed
## 6.3 Non-Persistent HTTP: Response Time
**RTT (Definition)**: Time for a small packet to travel from client to server and back

**HTTP Response Time (per object)**:
- One RTT to initiate TCP connection
- One RTT for HTTP request and first few bytes of HTTP response to return
- Object/file transmission time

$$
\text{Non-persistent HTTP response time = 2RTT + File Transmission Time}
$$
## 6.4 Persistent HTTP
**Non-Persistent HTTP Issues**:
- Requires 2 RTTs per object
- OS overhead for each TCP connection
- Browsers often open multiple parallel TCP connections to fetch referenced objects in parallel

**Persistent HTTP**:
- Server leaves connection open after sending response
- Subsequent HTTP messages between same client/server sent over open connection
- Client sends requests as soon as it encounters a referenced object
- As little as one RTT for all the referenced objects (cutting response time in half)

## 6.5 Parallel TCP Connections
- Browsers often open parallel TCP connections to fetch referenced objects
- Most P2P applications use parallel TCP connections
- Parallel TCP connections can reduce download time
- Commonly the number of connections is 2 to 6
- Available bandwidth should be shared among the connections

## 6.6 Pipelining
- Client sends requests as soon as it encounters a referenced object
- As little as one RTT for all the referenced objects (if the objects are small or the bandwidth is high)
![[Pasted image 20240120211651.png]]

## 6.7 HTTP Request Manage
- 2 Types of HTTP messages: request, response
- HTTP request message:
	- ASCII (human-readable format)
```
GET /index.html HTTP/1.1\r\n                // Request line (GET, POST, HEAD commands)
Host: www-net.cs.umass.edu\r\n              // Header lines:
User-Agent: Firefox/3.6.10\r\n 
Accept: text/html,application/xhtml+xml\r\n 
Accept-Language: en-us,en;q=0.5\r\n 
Accept-Encoding: gzip,deflate\r\n 
Accept-Charset: ISO-8859-1,utf-8;q=0.7\r\n 
Keep-Alive: 115\r\n Connection: keep-alive\r\n 
\r\n                                         // Carriage return, line feed at start of 
                                               line indicates end of header lines
```
- `\r`: Carriage return character
- `\n`: Line-feed character

**General Format**:
![[Pasted image 20240120212019.png]]

**Other HTTP Request Messages**:
1. POST Method:
	- Web page often includes form input
	- User input sent from client to server in entity body of HTTP POST request message
2. GET Method:
	- For sending data to server
	- Include user data in URL file of HTTP GET request message (following a '?')
3. HEAD Method:
	- Requests headers (only) that would be returned if specified URL were requested with a HTTP GET method
4. PUT Method:
	- Uploads new file (object) to server
	- Completely replaces file that exists at specified URL with content in entity body of POST HTTP request message

- HTTP Response Message:
```
HTTP/1.1 200 OK\r\n                  // Status line (protocol status code status phrase)
Date: Sun, 26 Sep 2010 20:09:20 GMT\r\n               // Header Lines:
Server: Apache/2.0.52 (CentOS)\r\n 
Last-Modified: Tue, 30 Oct 2007 17:00:02 GMT\r\n 
ETag: "17dc6-a5c-bf716880"\r\n 
Accept-Ranges: bytes\r\n 
Content-Length: 2652\r\n 
Keep-Alive: timeout=10, max=100\r\n 
Connection: Keep-Alive\r\n 
Content-Type: text/html; charset=ISO-8859-1\r\n 
\r\n 
data data data data data ...                        // Data, ex. requested HTML file
```

**HTTP Response Status Codes**
- Status code appears in 1st line in server-to-client response message. 
- Some sample codes:
	- **200 OK**: Request succeeded, requested object later in this message
	- **301 Moved Permanently**: Requested object moved, new location specified later in this message (in Location: field) 
	- **400 Bad Request**: Request msg not understood by server 
	- **404 Not Found**: Requested document not found on this server 
	- **505 HTTP Version Not Supported**

## 6.8 Status Codes
- **1xx: Informational** - Request received, continuing process
- **2xx: Success** - The action was successfully received, understood, and accepted
- **3xx: Redirection** - Further action must be taken in order to complete the request
- **4xx: Client Error** - The request contains bad syntax or cannot be fulfilled
- **5xx: Server Error** - The server failed to fulfill an apparently valid request

## 6.9 Trying out HTTP
1. Telnet to your favorite Web server: `telnet gaia.cs.umass.edu 80 `
	- Opens TCP connection to port 80 (default HTTP server port) at gaia.cs.umass. edu.
	- Anything typed in will be sent to port 80 at gaia.cs.umass.edu
2. type in a GET HTTP request: 
	```
	GET /kurose_ross/interactive/index.php 
	HTTP/1.1 Host: gaia.cs.umass.edu
	```
	- By typing this in (hit carriage return twice), you send this minimal (but complete) GET request to HTTP server
3. look at response message sent by HTTP server! (or use Wireshark to look at captured HTTP request/response) 